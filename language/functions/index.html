<!DOCTYPE html>
<html>
	<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
	<title> Functions &middot; The OOC Manual </title>
	
	<link rel="stylesheet" href="http://oocmanual.cogneco.com/css/reset.css">
	<link rel="stylesheet" href="http://oocmanual.cogneco.com/css/text.css">
	<link rel="stylesheet" href="http://oocmanual.cogneco.com/css/color.css">
	<link rel="stylesheet" href="http://oocmanual.cogneco.com/css/layout.css">
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://oocmanual.cogneco.com/apple-touch-icon-144-precomposed.png">
	<link rel="shortcut icon" href="http://oocmanual.cogneco.com/favicon.ico">
	
	<link href="" rel="alternate" type="application/rss+xml" title="The OOC Manual" />
</head>

	<body>
		<header>
  <h1><a href="http://oocmanual.cogneco.com">The OOC Manual</a></h1>
  <p></p>
</header>

		<nav>
	<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/introduction/">Introduction</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/installing/">Installing</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/">Language</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/modules/">Modules</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/values/">Values</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/tuples/">Tuples</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/control-structures/">Control Structures</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/collections/">Collections</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/functions/">Functions</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/first-class-functions/">First-class Functions</a>
		
	</li>
	
</ul>

		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/classes/">Classes</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/constructors/">Constructors</a>
		
	</li>
	
</ul>

		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/properties/">Properties</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/operators/">Operators</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/interfaces/">Interfaces</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/covers/">Covers</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/covers-vs-classes/">Covers vs Classes</a>
		
	</li>
	
</ul>

		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/enumerations/">Enumerations</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/generics/">Generics</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/generics2/">Generics 2</a>
		
	</li>
	
</ul>

		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/exceptions/">Exceptions</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/preprocessor/">Preprocessor</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/version-blocks/">Version</a>
		
	</li>
	
</ul>

		
	</li>
	
</ul>

		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/">sdk</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/">lang</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/types/">types</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/string/">string</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/numbers/">numbers</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/iterators/">iterators</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/exceptions/">exception</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/memory/">memory</a>
		
	</li>
	
</ul>

		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/structs/">structs</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/io/">io</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/math/">math</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/">os</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/process/">process</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/jobpool/">jobpool</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/coro/">coro</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/terminal/">terminal</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/pipe/">pipe</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/dynlib/">dynlib</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/mmap/">mmap</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/channel/">channel</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/system/">system</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/env/">env</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/shellutils/">shellutils</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/time/">time</a>
		
	</li>
	
</ul>

		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/net/">net</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/text/">text</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/threading/">threading</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/native/">native</a>
		
	</li>
	
</ul>

		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/">Tools</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/">Rock</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/basic/">Basic Usage</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/drivers/">Drivers</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/advanced/">Advanced Usage</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/use-files/">Use-files</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/use-files2/">Use-files 2</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/gc/">Garbage Collection</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/debug/">Debugging</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/packaging/">Packaging</a>
		
	</li>
	
</ul>

		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/sam/">Sam</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/editors/">Editors</a>
		
	</li>
	
</ul>

		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/troubleshooting/">Troubleshooting</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/glossary/">Glossary</a>
		
	</li>
	
</ul>

</nav>

		<main>
			<header>
				<h1>Functions</h1>
			</header>
			<nav id="TableOfContents">
<ul>
<li><a href="#toc_0">Functions</a></li>
<li><a href="#toc_1">Main</a></li>
<li><a href="#toc_2">Suffixes / overloading</a></li>
<li><a href="#toc_3">Variable arguments</a>
<ul>
<li><a href="#toc_4">ooc varargs</a></li>
<li><a href="#toc_5">C varargs</a></li>
</ul></li>
<li><a href="#toc_6">Extern functions</a></li>
<li><a href="#toc_7">By-ref parameters</a></li>
<li><a href="#toc_8">Closures</a></li>
</ul>
</nav>
			<article>
				

<h1 id="toc_0">Functions</h1>

<p>A parameterized piece of code is often packaged into a function.</p>

<p>Here&rsquo;s an example function that adds two numbers:</p>

<pre><code>#!ooc
add: func (a: Int, b: Int) -&gt; Int {
  return a + b
}

add(1, 2)
</code></pre>

<p>The syntax for function signatures is <code>NAME: func (ARG1, ARG2, ...) -&gt; RETURNTYPE</code>.
Both the argument definition list and the arrow return type parts are optional, in case
a function takes no argument, or returns nothing. Hence, the following definitions are
all perfectly equivalent:</p>

<pre><code>#!ooc
f: func () -&gt; Void {}
f: func -&gt; Void {}
f: func () {}
f: func {}
</code></pre>

<p>Arguments of the same type may be listed in short form: <code>name1, name2, name3: Type</code>.
Also, the <code>return</code> keyword is optional - it is only required to exit of the normal
function flow early. Hence, the first example can be rewritten like so:</p>

<pre><code>#!ooc
add: func (a, b: Int) -&gt; Int {
  a + b
}
</code></pre>

<p>In the absence of a <code>return</code> keyword in the body of a non-void function, the last
expression will be returned. This works with ifs, matches, etc.</p>

<h1 id="toc_1">Main</h1>

<p>Perhaps the most interesting function at first is the <code>main</code> function, aka the
entry point of a program. If not defined, one will be implicitly created. For
example, the following is a valid ooc program:</p>

<pre><code>#!ooc
&quot;Hi, world!&quot; println()
</code></pre>

<p>If we don&rsquo;t need to process command-line arguments, we can define the main function
simply like this:</p>

<pre><code>#!ooc
main: func {
  &quot;Hi, world!&quot; println()
}
</code></pre>

<p>Note that any could outside the main function (and outside class definitions, etc.)
will get executed before the code in the main function is. This gives a chance for
module to run initialization code (e.g. C libraries that need some routine to be called
before anything else, to set up stuff).</p>

<p>If we do want command-line arguments, we can do it the C way:</p>

<pre><code>#!ooc
main: func (argv: Int, argc: CString*) {
  for (i in 0..argv) {
    arg = argc[i]
    &quot;Got argument: %s&quot; printfln(arg toString())
  }
}
</code></pre>

<p>Or, we can use an array of strings:</p>

<pre><code>#!ooc
main: func (args: String[]) {
  // and so on..
}
</code></pre>

<p>Or, we can use an ArrayList of Strings, if more convenient:</p>

<pre><code>#!ooc
import structs/ArrayList
main: func (args: ArrayList&lt;String&gt;) {
  // etc.
}
</code></pre>

<p>Note that command line arguments might not be relevant for all ooc implementations.
One could imagine an ooc implementation that compiles down to JavaScript - in which
case, running in a browser, the command line arguments would always be empty.</p>

<h1 id="toc_2">Suffixes / overloading</h1>

<p>Functions can have the same name, but different signatures (argument lists and
return type), as long as they have different suffixes. They can be called without
suffix, in which case the compiler will infer the right function to call, or
explicitly by specifying the suffix by hand:</p>

<pre><code>#!ooc
add: func ~ints (a, b: Int) -&gt; Int { a + b }
add: func ~floats (a, b: Float) -&gt; Float { a + b }

add(1, 2) // calls ~ints variant
add(3.14, 5.0) // calls ~floats variant
add~floats(3, 5) // explicit call
</code></pre>

<h1 id="toc_3">Variable arguments</h1>

<p>Special slot in the argument list, can only be at the end, purpose is to accept
any number of arguments.</p>

<h2 id="toc_4">ooc varargs</h2>

<p>Store the number of arguments, and the types of each argument. Syntax is as follows:</p>

<pre><code>#!ooc
f: func (args: ...) {
  // body
}
</code></pre>

<p>Access <code>args count</code> to know how many arguments were passed.
Use <code>args iterator()</code> to be able to iterate through the arguments:</p>

<pre><code>#!ooc
printAll: func (things: ...) {
  &quot;Printing %d things&quot; printfln(things count)
  iter := things iterator()

  while (iter hasNext?()) {
    T := iter getNextType()
    &quot;The next argument is a %s&quot; printfln(T name)

    match T {
      case Int =&gt; &quot;%d&quot; printfln(iter next(Int))
      case Float =&gt; &quot;%.2f&quot; printfln(iter next(Float))
      case =&gt; &quot;Unsupported type&quot;
    }
  }
}
</code></pre>

<p>More simply, <code>each</code> can be used on a <code>VarArgs</code>:</p>

<pre><code>#!ooc
printAll: func (things: ...) {
  things each(|thing|
    match thing {
      case i: Int =&gt; &quot;%d&quot; printfln(i)
      case f: Float =&gt; &quot;%.2f&quot; printfln(f)
      case =&gt; &quot;&lt;unknown&gt;&quot;
    }
  )
}
</code></pre>

<h2 id="toc_5">C varargs</h2>

<p>Used by writing simply <code>...</code> in the argument list, not <code>args: ...</code>:</p>

<pre><code>#!ooc
f: func (firstArg: Type, ...) {
  // body
}
</code></pre>

<p>Only accessible through <code>va_start</code>, <code>va_next</code>, <code>va_end</code>. See <a href="http://en.wikipedia.org/wiki/Variadic_function">Variadic
function</a> on Wikipedia.</p>

<p>Useful only to relay a variable number of arguments to an extern C function,
since <code>va_arg</code> couldn&rsquo;t work (can&rsquo;t quote raw C types in ooc).</p>

<p>Example:</p>

<pre><code>#!ooc
vprintf: extern (s: CString, ...)

printf: func (s: String, ...) -&gt; This {
  list: VaList
  va_start(list, this)
  vprintf(s toCString(), list)
  va_end(list)
}
</code></pre>

<h1 id="toc_6">Extern functions</h1>

<p>To call a function defined elsewhere, for example in a C library, its prototype
needs to be defined</p>

<pre><code>#!ooc
exit: extern func (Int)
</code></pre>

<p>Lazy way: type-only args, thorough way: variable-decl-args.</p>

<pre><code>#!ooc
exit: extern func (exitCode: Int)
</code></pre>

<h1 id="toc_7">By-ref parameters</h1>

<p>Instead of having to dereference each time the parameter is accessed, just declare
it as a reference type:</p>

<pre><code>#!ooc
increment: func (a: Int*) { a@ += 1 }
// vs
increment: func (a: Int@) { a += 1 }
</code></pre>

<p>Saves typing, saves error, clearer code. Can still access the address via <code>argument&amp;</code>.</p>

<h1 id="toc_8">Closures</h1>

<p>A very concise way to pass a function as an argument. <code>each</code> is a typical
example:</p>

<pre><code>#!ooc
// definition
List: class &lt;T&gt; {
  each: func (f: Func (T)) { /* ... */ }
}

// usage
list := List&lt;Int&gt; new()
list each(|elem|
  // do something with elem, of type Int
)
</code></pre>

<p>Also works with several parameters:</p>

<pre><code>#!ooc
// definition
Map: class &lt;K, V&gt; {
  each: func (f: Func (K, V)) { /* ... */ }
}

// usage
map := Map&lt;String, Horse&gt; new()
map each(|key, value|
  // key is of type String, value is of type Horse
)
</code></pre>

<p>Argument types are inferred, hence, the code is very short.</p>

			</article>
			<footer>
				<p><span id="footer-copyright">2009-2014 Amos Wenger</span><span id="footer-license">CC BY-SA 3.0</span></p>
			</footer>
		</main>
		<footer>
  <p></p>
</footer>

	</body>
</html>
