<!DOCTYPE html>
<html>
	<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
	<title> First-class Functions &middot; The OOC Manual </title>
	
	<link rel="stylesheet" href="http://oocmanual.cogneco.com/css/reset.css">
	<link rel="stylesheet" href="http://oocmanual.cogneco.com/css/text.css">
	<link rel="stylesheet" href="http://oocmanual.cogneco.com/css/color.css">
	<link rel="stylesheet" href="http://oocmanual.cogneco.com/css/layout.css">
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://oocmanual.cogneco.com/apple-touch-icon-144-precomposed.png">
	<link rel="shortcut icon" href="http://oocmanual.cogneco.com/favicon.ico">
	
	<link href="" rel="alternate" type="application/rss+xml" title="The OOC Manual" />
</head>

	<body>
		<header>
  <h1><a href="http://oocmanual.cogneco.com">The OOC Manual</a></h1>
  <p></p>
</header>

		<nav>
	<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/introduction">Introduction</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language">Language</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/modules">Modules</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/values">Values</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/tuples">Tuples</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/control-structures">Control Structures</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/collections">Collections</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/functions">Functions</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/first-class-functions">First-class Functions</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/classes">Classes</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/constructors">Constructors</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/properties">Properties</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/operators">Operators</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/interfaces">Interfaces</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/covers">Covers</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/covers-vs-classes">Covers vs Classes</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/enumerations">Enumerations</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/generics">Generics</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/generics2">Generics 2</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/exceptions">Exceptions</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/preprocessor">Preprocessor</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/version-blocks">Version</a>
		
	</li>
	
</ul>


		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools">Tools</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock">Rock</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/basic">Basic Usage</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/drivers">Drivers</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/advanced">Advanced Usage</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/use-files">Use-files</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/use-files2">Use-files 2</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/gc">Garbage Collection</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/debug">Debugging</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/packaging">Packaging</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/sam">Sam</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/editors">Editors</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/troubleshooting">Troubleshooting</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk">sdk</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang">lang</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/types">types</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/string">string</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/numbers">numbers</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/iterators">iterators</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/exceptions">exception</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/memory">memory</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/structs">structs</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/io">io</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/math">math</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os">os</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/process">process</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/jobpool">jobpool</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/coro">coro</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/terminal">terminal</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/pipe">pipe</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/dynlib">dynlib</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/mmap">mmap</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/channel">channel</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/system">system</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/env">env</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/shellutils">shellutils</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/time">time</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/net">net</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/text">text</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/threading">threading</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/native">native</a>
		
	</li>
	
</ul>


		
	</li>
	
</ul>


</nav>


		<main>
			<header>
				<h1>First-class Functions</h1>
			</header>
			<nav id="TableOfContents">
<ul>
<li><a href="#toc_0">First-class functions</a>
<ul>
<li><a href="#toc_1">Intro</a></li>
<li><a href="#toc_2">Differences between function and first-class functions</a></li>
<li><a href="#toc_3">The type of first-class functions</a></li>
<li><a href="#toc_4">Type inference - ACS</a></li>
<li><a href="#toc_5">Other differences - member functions vs member first-class functions</a></li>
</ul></li>
</ul>
</nav>
			<article>
				

<h1 id="toc_0">First-class functions</h1>

<h2 id="toc_1">Intro</h2>

<p>Functions are pieces of code that can take arguments, and return values.</p>

<p>Named functions are declared with this syntax:</p>

<pre><code>    &lt;name&gt; : func &lt;arguments&gt; &lt;return type&gt; {
        &lt;body&gt;
    }
</code></pre>

<p>Where arguments are comma-separated, enclosed between parenthesis, and return type
is prefixed with a right arrow -&gt;.</p>

<p>Arguments may be omitted if the function doesn&rsquo;t take any, and return type
may be omitted too, if the function is void.</p>

<p>Example:</p>

<pre><code>    max: func (a, b: Int) -&gt; Int {
        a &gt; b ? a : b
    }
</code></pre>

<p>But this is a valid expression too:</p>

<pre><code>    func &lt;arguments&gt; &lt;return type&gt; {
        &lt;body&gt;
    }
</code></pre>

<p>And with decl-assign, we can declare a variable named &lsquo;max&rsquo;, equal
to this expression. And then use it very much like a function</p>

<pre><code>    max := func (a, b: Int) -&gt; Int {
        a &gt; b ? a : b
    }
    answer := max(-1, 42)
</code></pre>

<h2 id="toc_2">Differences between function and first-class functions</h2>

<p>The first difference is: functions are immutable. First-class functions
are variables, and thus can be overwritten by simple assignment.</p>

<pre><code>    // this is invalid: don't do that.
    someFunc: func {}
    someFunc = someOtherFunc

    // this, on the other hand, is valid
    someFunc := func {}
    someFunc = someOtherFunc
</code></pre>

<p>The second difference is: first-class functions can capture context.
Closures are first-class functions that capture context.</p>

<pre><code>    // here's a normal function
    clone: func (l: List&lt;Int&gt;) -&gt; List&lt;Int&gt; {
        copy := ArrayList&lt;Int&gt; new(l size())
        l each(func(element: Int) {
            copy add(element)
        })
        copy
    }
</code></pre>

<p>Here, our anonymous, first-class function which also happens to be a closure, is</p>

<pre><code>    func(element: Int) {
        copy add(element)
    }
</code></pre>

<p>It captures the context because we access &lsquo;copy&rsquo; in it - which isn&rsquo;t an
argument of the function, nor a variable declared inside the function.</p>

<p>It&rsquo;s declared outside, and still we can access it - that&rsquo;s what capturing
context is.</p>

<p>So let&rsquo;s sum up: first-class functions may be overwritten by assignment,
and may capture context.</p>

<h2 id="toc_3">The type of first-class functions</h2>

<p>So, when we do:</p>

<pre><code>    max := func (a, b: Int) -&gt; Int {
        a &gt; b ? a : b
    }
</code></pre>

<p>What exactly is the type of &lsquo;max&rsquo; ?</p>

<p>Let&rsquo;s declare it in two steps  instead:</p>

<pre><code>    max : Func (Int, Int) -&gt; Int
    max = func (a, b: Int) -&gt; Int {
        a &gt; b ? a : b
    }
</code></pre>

<p><code>Func</code> is a type that has a special syntax:</p>

<pre><code>    Func &lt;argument types&gt; &lt;return type&gt;
</code></pre>

<p>As with regular functions declaration, both argument types and return types
can be omitted.</p>

<h2 id="toc_4">Type inference - ACS</h2>

<p>Declaring the type of first-class functions is mostly useful in function arguments.</p>

<p>For example, in the SDK, the declaration of each goes like this:</p>

<pre><code>    List: class &lt;T&gt; {
        each: func(f: Func (T)) {
            // ...
        }
    }
</code></pre>

<p>So it takes a function that takes one argument of type T</p>

<p>Hence, clearly doing that in our clone function above:</p>

<pre><code>    l each(func(element: Int) {
        copy add(element)
    })
</code></pre>

<p>Is unnecessary. Since we know that l is a List<Int>, and that each takes
a Func (T) then we know that element is of type Int.</p>

<p>And thus, we can write that:</p>

<pre><code>    l each(|element|
        copy add(elements)
    )
</code></pre>

<p>The proper syntax for that is</p>

<pre><code>    call(|&lt;name of arguments&gt;|
        &lt;body&gt;
    )
</code></pre>

<p>If there are no arguments, this is valid:</p>

<pre><code>    call(||
        &lt;body&gt;
    )
</code></pre>

<p>And is then equivalent to:</p>

<pre><code>    call(func {
        &lt;body&gt;
    })
</code></pre>

<p>The return type is inferred as well.</p>

<h2 id="toc_5">Other differences - member functions vs member first-class functions</h2>

<pre><code>    Dog: class {

        shout: func {
            &quot;Woof woof&quot; println()
        }

    }

    d := Dog new()
    d shout()

    Dog shout = func {
        &quot;Ruff ruff&quot; println()
    }
    d2 := Dog new()
    d shout()
    d2 shout()
</code></pre>

<p>Prints:</p>

<pre><code>    Woof woof
    Ruff ruff
    Ruff ruff
</code></pre>

<p>When assigning &lsquo;Dog shout&rsquo;, we change the member method of <em>all</em> past and
future Dog instances. This happens because &lsquo;shout&rsquo; is actually stored in the meta-class</p>

<p>Consider the differences with that instead:</p>

<pre><code>    Dog: class {

        shout := func {
            &quot;Woof woof&quot; println()
        }

    }

    d := Dog new()
    d shout()

    d shout = func {
        &quot;Ruff ruff&quot; println()
    }
    d2 := Dog new()
    d shout()
    d2 shout()
</code></pre>

<p>Prints:</p>

<pre><code>    Woof woof
    Ruff ruff
    Woof woof
</code></pre>

<p>Here, &lsquo;shout&rsquo; is a member variable. Assigning to &rsquo;d shout&rsquo; changes it
only for that instance, so d2 shout isn&rsquo;t changed.</p>

			</article>
			<footer>
				<p><span id="footer-copyright">2009-2014 Amos Wenger</span><span id="footer-license">CC BY-SA 3.0</span></p>
			</footer>
		</main>
		<footer>
  <p></p>
</footer>

	</body>
</html>
