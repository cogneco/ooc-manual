<!DOCTYPE html>
<html>
	<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
	<title> Use-files &middot; The OOC Manual </title>
	
	<link rel="stylesheet" href="http://oocmanual.cogneco.com/css/reset.css">
	<link rel="stylesheet" href="http://oocmanual.cogneco.com/css/text.css">
	<link rel="stylesheet" href="http://oocmanual.cogneco.com/css/color.css">
	<link rel="stylesheet" href="http://oocmanual.cogneco.com/css/layout.css">
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://oocmanual.cogneco.com/apple-touch-icon-144-precomposed.png">
	<link rel="shortcut icon" href="http://oocmanual.cogneco.com/favicon.ico">
	
	<link href="" rel="alternate" type="application/rss+xml" title="The OOC Manual" />
</head>

	<body>
		<header>
  <h1><a href="http://oocmanual.cogneco.com">The OOC Manual</a></h1>
  <p></p>
</header>

		<nav>
	<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/introduction">Introduction</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/installing">Installing</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language">Language</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/modules">Modules</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/values">Values</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/tuples">Tuples</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/control-structures">Control Structures</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/collections">Collections</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/functions">Functions</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/first-class-functions">First-class Functions</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/classes">Classes</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/constructors">Constructors</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/properties">Properties</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/operators">Operators</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/interfaces">Interfaces</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/covers">Covers</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/covers-vs-classes">Covers vs Classes</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/enumerations">Enumerations</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/generics">Generics</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/generics2">Generics 2</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/exceptions">Exceptions</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/preprocessor">Preprocessor</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/version-blocks">Version</a>
		
	</li>
	
</ul>


		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk">sdk</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang">lang</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/types">types</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/string">string</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/numbers">numbers</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/iterators">iterators</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/exceptions">exception</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/memory">memory</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/structs">structs</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/io">io</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/math">math</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os">os</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/process">process</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/jobpool">jobpool</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/coro">coro</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/terminal">terminal</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/pipe">pipe</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/dynlib">dynlib</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/mmap">mmap</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/channel">channel</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/system">system</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/env">env</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/shellutils">shellutils</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/time">time</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/net">net</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/text">text</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/threading">threading</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/native">native</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools">Tools</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock">Rock</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/basic">Basic Usage</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/drivers">Drivers</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/advanced">Advanced Usage</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/use-files">Use-files</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/use-files2">Use-files 2</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/gc">Garbage Collection</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/debug">Debugging</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/packaging">Packaging</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/sam">Sam</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/editors">Editors</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/troubleshooting">Troubleshooting</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/glossary">Glossary</a>
		
	</li>
	
</ul>


</nav>


		<main>
			<header>
				<h1>Use-files</h1>
			</header>
			<nav id="TableOfContents">
<ul>
<li><a href="#toc_0">Usefiles explained</a></li>
<li><a href="#toc_1">Examples</a></li>
<li><a href="#toc_2">Fields</a></li>
<li><a href="#toc_3">Version blocks</a></li>
</ul>
</nav>
			<article>
				

<h1 id="toc_0">Usefiles explained</h1>

<p>A usefile describes an ooc package, ie. a collection of modules and contains information
how to compile and link that specific collection of ooc files.
It also denotes if the package should compile to an executable or a shared/static library.</p>

<p>Usefiles are not a totally novel concept. They are comparable to <code>pkg-config</code> files or, to
some degree, similar to build system files like CMake or SCons.</p>

<p>However, in ooc, (and this is a pretty new thing!),
the compiler rock itself reads and handles these usefiles.</p>

<h1 id="toc_1">Examples</h1>

<p>Let&rsquo;s start off with some examples. Following is the repository structure of
<a href="https://github.com/nddrylliog/ooc-zeromq">ooc-zeromq</a>, a <a href="http://zeromq.org">zeromq</a> binding
for ooc:</p>

<pre><code>.
├── LICENSE
├── README.md
├── samples
│   ├── ...
├── source
│   └── zeromq.ooc
└── zeromq.use
</code></pre>

<p>Let&rsquo;s assume that you cloned the repository into a subdirectory of your ooc library path
(which consists of the paths in the <code>OOC_LIBS</code> environment variable).</p>

<p>And here are the contents of <code>zeromq.use</code> (shortened for brevity):</p>

<pre><code>#!ooc
Name: zeromq
Description: The 0MQ lightweight messaging kernel
Version: 2010-06-16
SourcePath: source
Includes: zmq.h
Libs: -lzmq
</code></pre>

<p>A usefile should always contain the name, description and version of its package.</p>

<p>In addition, this usefile tells rock that the actual ooc files reside in the subdirectory
<code>source</code> (which will be added to the so-called sourcepath).</p>

<p>Also, since this is a C library binding, the zeromq C header needs to be included,
and the <code>-lzmq</code> flag needs to be passed to the linker.</p>

<p>So far so good. But what are the benefits of writing such a file?</p>

<p>If you now want to use this package in any of your projects, you can just write:</p>

<pre><code>#!ooc
use zeromq
</code></pre>

<p>at the top of your ooc file, and rock will automatically look through your library path
(the paths in the <code>OOC_LIBS</code> environment variable) for a file called <code>zeromq.use</code> and find
the usefile above. Now it parses this usefile and instantly knows not only where it can
find the ooc-zeromq ooc files, but also what C headers need to be included and
what libraries need to be linked.</p>

<p>As a result, you can now just import the ooc-zeromq ooc file like this:</p>

<pre><code>#!ooc
import zeromq
</code></pre>

<p>and hack away.</p>

<p>Another simpler example is the <a href="https://github.com/nddrylliog/sam">sam</a> usefile. sam is
different because it compiles to an executable file:</p>

<pre><code>#!ooc
Name: sam
Description: Sam keeps your ooc repos up to date
SourcePath: source
Main: sam.ooc
</code></pre>

<p>Once again, the usefile contains name and description (no version here, though!) and
the sourcepath.</p>

<p>The new thing: <code>Main</code> denotes the entry point for the executable, e.g. the file
containing the <code>main</code> function. rock looks for a file named this in the source path,
which here contains the subdirectory source/.</p>

<p>To build sam, you can now just run:</p>

<pre><code>#!bash
rock -v
</code></pre>

<p>which will look for a usefile in your current directory and build the package. As a result,
you get a <code>sam</code> executable &ndash; and all of that without using a third party build system!</p>

<h1 id="toc_2">Fields</h1>

<p>A list of all currently supported fields in usefiles follows.</p>

<ul>
<li><code>Name</code>, <code>Description</code> and <code>Version</code> contain metadata about the package
and version</li>
<li><code>Pkgs</code> contains a comma-separated list of <code>pkg-config</code> packages this
package depends on. rock will invoke <code>pkg-config</code> with these packages
and add the resulting C flags and linker flags to its pipeline</li>
<li><code>CustomPkg</code> can be used to specify the name of a <code>pkg-config</code>-like tool
that should be used instead. For example, the ooc sdl2 binding sets
this to <code>sdl2-config</code></li>
<li><code>Libs</code> contains a comma-separated list of linker flags like <code>-lSDL2_image</code></li>
<li><code>Frameworks</code>: OSX-only, specify Frameworks to be linked with (example: <code>OpenGL</code>)</li>
<li><code>Includes</code> can be used to specify C headers that should be included
(as a comma-separated list)</li>
<li><code>PreMains</code>: List of compiler flags that, if specified from a .pc file or a .use file,
(maybe conditioned by a version block), must appear before the main compilation unit.
Example: <code>-lSDL2main</code> on Windows.</li>
<li><code>Linker</code> can be used to specify a <code>ld</code> replacement</li>
<li><code>LibPaths</code> and <code>IncludePaths</code> are comma-separated lists and contain
paths that should be added to the linker or C include paths</li>
<li><code>AndroidLibs</code>, <code>AndroidIncludePaths</code>: Android-specific properties that are
only used with the Android driver.</li>
<li><code>Additionals</code>: can be used to add <code>.c</code> files to be compiled along with the .ooc code.
Relative paths (starting with <code>./</code>) will have the .c file be copied locally.</li>
<li><code>Requires</code> can be used to specify requirements (denoted by usefile
names), for example for sam</li>
<li><code>SourcePath</code> can be used to add a path to the source path</li>
<li><code>Imports</code> contains a comma-separated list of modules that should be
implicitly imported when <code>use yourusefile</code> is used.</li>
<li><code>Origin</code> is ignored by rock, but it traditionally specifies the
git repository url of that package</li>
<li><code>Main</code> is the name of the entrypoint file</li>
<li>all fields starting with <code>_</code> are ignored by rock</li>
</ul>

<h1 id="toc_3">Version blocks</h1>

<p>Similarily to ooc&rsquo;s <a href="/docs/lang/preprocessor/#version-blocks">version blocks</a>, usefile version blocks
can be used to work with different requirements on different platforms.</p>

<p>The syntax is similar to version blocks in ooc. Here is an example from
<a href="https://github.com/nddrylliog/isaac-paper">Paper Isaac</a>&rsquo;s usefile:</p>

<pre><code>#!ooc
Name: isaac
Version: 0.1
Requires: dye, bleep, gnaar
SourcePath: source
Main: isaac

version (windows) {
  Libs: ./isaac.res
}
</code></pre>

<p>Compiling under windows, the linker command line will contain the additional file
<code>./isaac.res</code>.</p>

			</article>
			<footer>
				<p><span id="footer-copyright">2009-2014 Amos Wenger</span><span id="footer-license">CC BY-SA 3.0</span></p>
			</footer>
		</main>
		<footer>
  <p></p>
</footer>

	</body>
</html>
