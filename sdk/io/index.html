<!DOCTYPE html>
<html>
	<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
	<title> io &middot; The OOC Manual </title>
	
	<link rel="stylesheet" href="http://oocmanual.cogneco.com/css/reset.css">
	<link rel="stylesheet" href="http://oocmanual.cogneco.com/css/text.css">
	<link rel="stylesheet" href="http://oocmanual.cogneco.com/css/color.css">
	<link rel="stylesheet" href="http://oocmanual.cogneco.com/css/layout.css">
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://oocmanual.cogneco.com/apple-touch-icon-144-precomposed.png">
	<link rel="shortcut icon" href="http://oocmanual.cogneco.com/favicon.ico">
	
	<link href="" rel="alternate" type="application/rss+xml" title="The OOC Manual" />
</head>

	<body>
		<header>
  <h1><a href="http://oocmanual.cogneco.com">The OOC Manual</a></h1>
  <p></p>
</header>

		<nav>
	<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/introduction/">Introduction</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/installing/">Installing</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/">Language</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/modules/">Modules</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/values/">Values</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/tuples/">Tuples</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/control-structures/">Control Structures</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/collections/">Collections</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/functions/">Functions</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/first-class-functions/">First-class Functions</a>
		
	</li>
	
</ul>

		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/classes/">Classes</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/constructors/">Constructors</a>
		
	</li>
	
</ul>

		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/properties/">Properties</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/operators/">Operators</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/interfaces/">Interfaces</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/covers/">Covers</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/covers-vs-classes/">Covers vs Classes</a>
		
	</li>
	
</ul>

		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/enumerations/">Enumerations</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/generics/">Generics</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/generics2/">Generics 2</a>
		
	</li>
	
</ul>

		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/exceptions/">Exceptions</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/preprocessor/">Preprocessor</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/version-blocks/">Version</a>
		
	</li>
	
</ul>

		
	</li>
	
</ul>

		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/">sdk</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/">lang</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/types/">types</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/string/">string</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/numbers/">numbers</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/iterators/">iterators</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/exceptions/">exception</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/memory/">memory</a>
		
	</li>
	
</ul>

		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/structs/">structs</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/io/">io</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/math/">math</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/">os</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/process/">process</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/jobpool/">jobpool</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/coro/">coro</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/terminal/">terminal</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/pipe/">pipe</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/dynlib/">dynlib</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/mmap/">mmap</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/channel/">channel</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/system/">system</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/env/">env</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/shellutils/">shellutils</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/time/">time</a>
		
	</li>
	
</ul>

		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/net/">net</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/text/">text</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/threading/">threading</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/native/">native</a>
		
	</li>
	
</ul>

		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/">Tools</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/">Rock</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/basic/">Basic Usage</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/drivers/">Drivers</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/advanced/">Advanced Usage</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/use-files/">Use-files</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/use-files2/">Use-files 2</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/gc/">Garbage Collection</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/debug/">Debugging</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/packaging/">Packaging</a>
		
	</li>
	
</ul>

		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/sam/">Sam</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/editors/">Editors</a>
		
	</li>
	
</ul>

		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/troubleshooting/">Troubleshooting</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/glossary/">Glossary</a>
		
	</li>
	
</ul>

</nav>

		<main>
			<header>
				<h1>io</h1>
			</header>
			<nav id="TableOfContents">
<ul>
<li><a href="#toc_0">The io package</a></li>
<li><a href="#toc_1">File</a>
<ul>
<li><a href="#toc_2">Paths</a></li>
<li><a href="#toc_3">Basic I/O</a></li>
<li><a href="#toc_4">Walking through directories</a></li>
<li><a href="#toc_5">Permissions</a></li>
<li><a href="#toc_6">Current directory</a></li>
</ul></li>
<li><a href="#toc_7">Reader / Writer</a>
<ul>
<li><a href="#toc_8">Reader basics</a></li>
<li><a href="#toc_9">Writer basics</a></li>
</ul></li>
<li><a href="#toc_10">BinarySequence</a>
<ul>
<li><a href="#toc_11">BinarySequenceReader</a></li>
<li><a href="#toc_12">BinarySequenceWriter</a></li>
</ul></li>
</ul>
</nav>
			<article>
				

<h1 id="toc_0">The io package</h1>

<p>Whether you want to read from file, write to files,
walk through directories, or build data in-memory, the
io package contains everything you need</p>

<h1 id="toc_1">File</h1>

<p>The <code>io/File</code> module is a good starting point to handle
files. Instanciating one with a path will allow to test for
various attributes:</p>

<pre><code>#!ooc
f := File new(&quot;/etc/hosts&quot;)

f exists?()
f dir?() // is a directory?
f file?() // is a file?
f link?() // is a symlink?

f getSize() // size in bytes
</code></pre>

<h2 id="toc_2">Paths</h2>

<p>For paths like <code>/path/to/somewhere</code>, <code>getName()</code> will return
the <code>somewhere</code> part, and <code>getParent</code> will return an instance
of <code>File</code> corresponding to <code>/path/to</code>, or null if the path is
at the root of a file system.</p>

<p>The <code>getReducedPath</code> method will resolve paths like <code>a/b/../../c</code>
to <code>c</code>. It is a form of canonicalization, suitable for comparing
paths.</p>

<h2 id="toc_3">Basic I/O</h2>

<p>The <code>copyTo</code> method will copy a file to the given <code>dstFile</code>.</p>

<pre><code>#!ooc
src := File new(&quot;./conf/default.conf&quot;)
dst := File new(Env get(&quot;HOME&quot;), &quot;.myapp&quot;)
src copyTo(dst)
</code></pre>

<p>The <code>remove</code> method will remove a file, but will fail to remove
a directory.</p>

<pre><code>#!ooc
tmpFile remove()
</code></pre>

<p>The <code>read</code> and <code>write</code> methods will read a whole file and replace the content
of a file with the given string, respectively.</p>

<pre><code>#!ooc
respectify: func (file: File) {
  text := file read()
  file write(text replaceAll(&quot;yes&quot;, &quot;yes, sir&quot;))
}
</code></pre>

<h2 id="toc_4">Walking through directories</h2>

<p>The <code>getChildren</code> method will return a list of <code>File</code> instances
corresponding to the files in a directory, whereas the <code>getChildrenNames</code>
method will return a list of strings corresponding to the name of
files in the given directory.</p>

<pre><code>#!ooc
f := File new(&quot;/etc&quot;)
for (child in f getChildren()) {
  // child might be a file or a directory with
  // children of its own
}
</code></pre>

<p>The <code>walk</code> method allows a recursive walk on all the children
of a given directory. When the callback returns false, the search
is terminated.</p>

<pre><code>#!ooc
findFile: func (prefix: String) -&gt; File {
  result: File
  baseDirectory walk(|f|
    if (f startsWith?(prefix)) {
      result = f
      return false
    }
    true
  )
  result
}
</code></pre>

<h2 id="toc_5">Permissions</h2>

<p>The methods <code>ownerPerm</code>, <code>groupPerm</code>, and <code>otherPerm</code> return an int mask with
permissions.</p>

<p>Note that using octal number literals might be a good idea to test against
that. Unlike C, <code>0777</code> is decimal in ooc. You want to write <code>0c777</code> instead.</p>

<h2 id="toc_6">Current directory</h2>

<p>The static method <code>File getCwd()</code> will return the current working directory on
any platform.</p>

<h1 id="toc_7">Reader / Writer</h1>

<p>The <code>io/Reader</code> and <code>io/Writer</code> modules contains interfaces used for input/output.</p>

<p>For files, use the <code>io/FileReader</code> and <code>io/FileWriter</code> implementations. To work in
memory, use the <code>io/BufferReader</code> and <code>io/BufferWriter</code> implementations.</p>

<p>A reader or writer should be closed (by calling <code>reader close()</code> or <code>writer close()</code>)
when done with it, so that the corresponding resources may be freed.</p>

<h2 id="toc_8">Reader basics</h2>

<p>Some C libraries have an interface similar to <code>io/Reader</code>. The main I/O loop might
look like the following:</p>

<pre><code>#!ooc
import io/Reader

process: func (reader: Reader) {
  buffer := Buffer new(1024)

  while (reader hasNext?()) {
    bytesRead := reader read(buffer)
    // do something with buffer
  }
  reader close()
}
</code></pre>

<p>A reader can also work with raw memory chunks:</p>

<pre><code>#!ooc
onRead: func (reader: Reader, buffer: UInt8*, bufferSize: Int) {
  // fill buffer from beginning, 0 is the offset
  reader read(buffer, 0, bufferSize)
}
</code></pre>

<p>Or one character at a time:</p>

<pre><code>#!ooc
match (reader read()) {
  case 'A' =&gt; &quot;Good!&quot;
  case 'F' =&gt; &quot;Also good.&quot;
  case =&gt; &quot;Meh.&quot;
}
</code></pre>

<p>An entire stream can be read to a String:</p>

<pre><code>#!ooc
fr := FileReader new(&quot;file.txt&quot;)
contents := fr readAll()
fr close()
</code></pre>

<p>(Note that this would compactly be achieved by <code>File new(&quot;file.txt&quot;) read()</code>)</p>

<p>For more details, refer to the oocdocs.</p>

<h2 id="toc_9">Writer basics</h2>

<p>Similarly, the writer interface works with buffers, raw memory chunks, single characters,
or strings as needed:</p>

<pre><code>#!ooc
manipulate: func (w: Writer) {
  // char
  w write('a')

  // string
  w write(&quot;abc&quot;)

  // buffer
  chars := &quot;moonlight&quot; toCString()
  w write(chars, 4) // only writes &quot;moon&quot;
}
</code></pre>

<p>For more details, refer to the oocdocs.</p>

<h1 id="toc_10">BinarySequence</h1>

<p>The <code>io/BinarySequence</code> module is meant to help deal with binary protocols, precise
on the width and endianness of types being written to a stream.</p>

<h2 id="toc_11">BinarySequenceReader</h2>

<p>Here&rsquo;s an example:</p>

<pre><code>#!ooc
// read a file as binary
file := File new(&quot;assets&quot;, &quot;binary.dat&quot;)
seq := BinarySequenceReader new(FileReader new(file))

// read an 16-bit unsigned int:
numElements := seq u16()

for (i in 0..numElements) {
  // coordinates are two floats
  x := seq float32()
  y := seq float32()
  // do something with x, y
}

// check magicn number at the end
assert (seq s32() == 0xdeadbeef)
</code></pre>

<p>For more details, refer to the oocdocs.</p>

<h2 id="toc_12">BinarySequenceWriter</h2>

<p>The corresponding module exists for writing binary sequences.</p>

<pre><code>#!ooc
// write a binary file
file := File new(&quot;assets&quot;, &quot;binary.dat&quot;)
seq := BinarySequenceWriter new(FileWriter new(file))

seq u16(elements size)

for (elem in elements) {
  seq float32(elem x)
  seq float32(elem y)
}

seq s32(0xdeadbeef)
</code></pre>

<p>For more details, refer to the oocdocs.</p>

			</article>
			<footer>
				<p><span id="footer-copyright">2009-2014 Amos Wenger</span><span id="footer-license">CC BY-SA 3.0</span></p>
			</footer>
		</main>
		<footer>
  <p></p>
</footer>

	</body>
</html>
