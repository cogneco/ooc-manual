<!DOCTYPE html>
<html>
	<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
	<title> process &middot; The OOC Manual </title>
	
	<link rel="stylesheet" href="http://oocmanual.cogneco.com/css/reset.css">
	<link rel="stylesheet" href="http://oocmanual.cogneco.com/css/text.css">
	<link rel="stylesheet" href="http://oocmanual.cogneco.com/css/color.css">
	<link rel="stylesheet" href="http://oocmanual.cogneco.com/css/layout.css">
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://oocmanual.cogneco.com/apple-touch-icon-144-precomposed.png">
	<link rel="shortcut icon" href="http://oocmanual.cogneco.com/favicon.ico">
	
	<link href="" rel="alternate" type="application/rss+xml" title="The OOC Manual" />
</head>

	<body>
		<header>
  <h1><a href="http://oocmanual.cogneco.com">The OOC Manual</a></h1>
  <p></p>
</header>

		<nav>
	<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/introduction">Introduction</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language">Language</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/modules">Modules</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/values">Values</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/tuples">Tuples</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/control-structures">Control Structures</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/collections">Collections</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/functions">Functions</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/first-class-functions">First-class Functions</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/classes">Classes</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/constructors">Constructors</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/properties">Properties</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/operators">Operators</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/covers">Covers</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/covers-vs-classes">Covers vs Classes</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/enumerations">Enumerations</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/generics">Generics</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/generics2">Generics 2</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/exceptions">Exceptions</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/preprocessor">Preprocessor</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/language/version-blocks">Version</a>
		
	</li>
	
</ul>


		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools">Tools</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock">Rock</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/basic">Basic Usage</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/drivers">Drivers</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/advanced">Advanced Usage</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/use-files">Use-files</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/use-files2">Use-files 2</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/gc">Garbage Collection</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/debug">Debugging</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/rock/packaging">Packaging</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/sam">Sam</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/tools/editors">Editors</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/troubleshooting">Troubleshooting</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk">sdk</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang">lang</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/types">types</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/string">string</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/numbers">numbers</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/iterators">iterators</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/exceptions">exception</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/lang/memory">memory</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/structs">structs</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/io">io</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/math">math</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os">os</a>
		
		<ul>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/process">process</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/jobpool">jobpool</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/coro">coro</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/terminal">terminal</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/pipe">pipe</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/dynlib">dynlib</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/mmap">mmap</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/channel">channel</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/system">system</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/env">env</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/shellutils">shellutils</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/os/time">time</a>
		
	</li>
	
</ul>


		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/net">net</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/text">text</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/threading">threading</a>
		
	</li>
	
	<li>
		<a href="http://oocmanual.cogneco.com/sdk/native">native</a>
		
	</li>
	
</ul>


		
	</li>
	
</ul>


</nav>


		<main>
			<header>
				<h1>process</h1>
			</header>
			<nav id="TableOfContents">
<ul>
<li><a href="#toc_0">The os/Process module</a></li>
<li><a href="#toc_1">Basic usage</a>
<ul>
<li><a href="#toc_2">Manual wait and pid</a></li>
</ul></li>
<li><a href="#toc_3">Process settings</a>
<ul>
<li><a href="#toc_4">Current working directory</a></li>
<li><a href="#toc_5">Environment</a></li>
</ul></li>
<li><a href="#toc_6">Communicating with a process</a>
<ul>
<li><a href="#toc_7">Redirecting stdin, stdout, stderr</a></li>
<li><a href="#toc_8">Streaming output</a></li>
</ul></li>
<li><a href="#toc_9">Terminate or kill a process</a></li>
</ul>
</nav>
			<article>
				

<h1 id="toc_0">The os/Process module</h1>

<p>The Process module deals with everything related to launching a child process, waiting for
its status or signals, and communicating with it.</p>

<h1 id="toc_1">Basic usage</h1>

<p>A process can be launched by providing an array or a list of arguments to the <code>Process</code> constructor:</p>

<pre><code>#!ooc
import os/Process

p := Process new([&quot;cat&quot;, &quot;/etc/hosts&quot;])
exitCode := p execute()

// at this point, the process has ended
// and 'exitCode' contains the value returned by the program
</code></pre>

<p>Instead of running execute, one might want to run <code>getOutput</code> directly, to get
the standard output of the process as a string</p>

<pre><code>#!ooc
p := Process new([&quot;cat&quot;, &quot;/etc/hosts&quot;])
out := p getOutput()
// out now contains the contents of the /etc/hosts file
</code></pre>

<p>Or getErrOutput to get the standard error output:</p>

<pre><code>#!ooc
p := Process new([&quot;cat&quot;, &quot;/etc/hosts&quot;])
err := p getErrOutput()
// err is empty
</code></pre>

<p>To retrieve the result of both stderr and stdout, see the &lsquo;Redirecting&rsquo; section
below.</p>

<p>However, depending on your use case, that might not be the best way to do it.</p>

<h2 id="toc_2">Manual wait and pid</h2>

<p><code>execute</code> will start the child process, wait for it to finish, and print the output.</p>

<p>However, we can do things manually if we want:</p>

<pre><code>#!ooc
p := Process new([&quot;curl&quot;, &quot;example.org&quot;])
p executeNoWait()
p wait()
</code></pre>

<p>The <code>wait</code> method will wait until the child process has exited or errored. If you
just want to check if a process is still running, <code>waitNoHang</code> can be used instead:</p>

<pre><code>#!ooc
p := Process new([&quot;curl&quot;, &quot;example.org&quot;])
p executeNoWait()
while (p waitNoHang() == -1) {
    Time sleepMilli(20)
}
</code></pre>

<p>To execute a bunch of processes in parallel, using a <a href="/docs/sdk/os/jobpool">JobPool</a> is easier and
more suitable.</p>

<h1 id="toc_3">Process settings</h1>

<h2 id="toc_4">Current working directory</h2>

<p>By default, a process will inherit from the current working directory. To make
the child process run in a specified directory, use the <code>setCwd</code> method</p>

<pre><code>#!ooc
p := Process new([&quot;cat&quot;, &quot;hosts&quot;])
p setCwd(&quot;/etc&quot;)
p execute()
</code></pre>

<h2 id="toc_5">Environment</h2>

<p>To specify custom environment variables for a process, use the <code>setEnv</code> method
with a <code>HashMap&lt;String, String&gt;</code>:</p>

<pre><code>#!ooc
p := Process new([&quot;bash&quot;, &quot;-c&quot;, &quot;echo $MYVAR&quot;])

env := HashMap&lt;String, String&gt; new()
env put(&quot;MYVAR&quot;, &quot;42&quot;)
p setEnv(env)

// prints 42
p execute()
</code></pre>

<h1 id="toc_6">Communicating with a process</h1>

<h2 id="toc_7">Redirecting stdin, stdout, stderr</h2>

<p>One may use <a href="/docs/sdk/os/pipe/">pipes</a> to redirect the standard input, output, or error stream of
a process.</p>

<pre><code>#!ooc
import os/[Process, Pipe, PipeReader]

p := Process new([&quot;some&quot;, &quot;process&quot;])

(out, err) := (Pipe new(), Pipe new())
p setStdout(out)
p setStderr(err)

exitCode := p execute()

outString := PipeReader new(out) toString()
errString := PipeReader new(err) toString()

out close('r'). close('w')
err close('r'). close('w')

// we now have the exit code in exitCode, the
// stdout in outString, and the stderr in errString
</code></pre>

<h2 id="toc_8">Streaming output</h2>

<p>This can be used to stream stdout to the output of our main program, if the launched
process is interactive. If blinkenlights is still up and running when you try this, it
should display star wars scene in ASCII art:</p>

<pre><code>#!ooc
p := Process new([&quot;nc&quot;, &quot;towel.blinkenlights.nl&quot;, &quot;23&quot;])

out := Pipe new()
out setNonBlocking()
p setStdout(out)

p executeNoWait()

while (true) {
    chr := out read()
    if (chr != '\0') {
        chr print()
    } else if(p waitNoHang() &gt; 0) {
        // process is done
        break
    }
}
</code></pre>

<h1 id="toc_9">Terminate or kill a process</h1>

<p>The <code>terminate</code> method will send a process the <code>SIGTERM</code> message, while the <code>kill</code> method
will send a process the <code>SIGKILL</code> message.</p>

<p>This can be used to gracefully end a process:</p>

<pre><code>#!ooc
p terminate()
if (p waitNoHang() != -1) {
    // give a few seconds of grace..
    Time sleepSec(3)
}

if (p waitNoHang() != -1) {
    // still not finished? alright, that's enough
    p kill()
}
</code></pre>

			</article>
		</main>
		<footer>
  <p></p>
</footer>

	</body>
</html>
